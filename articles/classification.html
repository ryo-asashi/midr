<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Interpretation of Classification Models • midr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interpretation of Classification Models">
<meta name="description" content="Demonstrates how to use the midr package to interpret classification models.">
<meta property="og:description" content="Demonstrates how to use the midr package to interpret classification models.">
<meta property="og:image" content="https://ryo-asashi.github.io/midr/logo.png">
<style>
[data-bs-theme="dark"] img,
[data-bs-theme="dark"] .contents img,
[data-bs-theme="dark"] .examples img {
  filter: none !important;
  mix-blend-mode: normal !important;
}
img {
  background-color: #ffffff !important;
  border-radius: 4px;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">midr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.3.901</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/index.html">Package Articles</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">- Interpretation of Regression Models</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">- Interpretation of Classification Models</a></li>
    <li><a class="dropdown-item" href="../articles/graphics.html">- Visualization with graphics package</a></li>
    <li><a class="dropdown-item" href="../articles/ggplot2.html">- Visualization with ggplot2 package</a></li>
    <li><a class="dropdown-item" href="../articles/colortheme.html">- Getting Started with Color Themes</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Publications</h6></li>
    <li><a class="external-link dropdown-item" href="https://arxiv.org/abs/2506.08338">- Working Paper (arXiv)</a></li>
    <li><a class="dropdown-item" href="../midr_jarip.pdf">- JARIP Bulletin (Japanese, PDF)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ryo-asashi/midr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Interpretation of Classification Models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ryo-asashi/midr/blob/main/vignettes/articles/classification.Rmd" class="external-link"><code>vignettes/articles/classification.Rmd</code></a></small>
      <div class="d-none name"><code>classification.Rmd</code></div>
    </div>

    
    
<p>This article presents some examples of the interpretation of
classification models using <code>midr</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ryo-asashi/midr" class="external-link">midr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mfrasco/Metrics" class="external-link">Metrics</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="../reference/theme_midr.html">theme_midr</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="classification-task">Classification Task<a class="anchor" aria-label="anchor" href="#classification-task"></a>
</h2>
<p>We use the titanic dataset, which is available on the website <a href="https://www.encyclopedia-titanica.org/" class="external-link uri">https://www.encyclopedia-titanica.org/</a> and is included
in the <code>DALEX</code> package. The dataset has 9 variables for 2207
people, of which 1317 were passengers and 890 were crew members. We fit
some classification models that predict who survived the tragedy and who
did not, and then we interpret the fitted models.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># benchmark classification task</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://modeloriented.github.io/DALEX/" class="external-link">DALEX</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Welcome to DALEX (version: 2.5.3).</span></span>
<span><span class="co">#&gt; Find examples and detailed introduction at: http://ema.drwhy.ai/</span></span>
<span><span class="co">#&gt; Additional features will be available after installation of: ggpubr.</span></span>
<span><span class="co">#&gt; Use 'install_dependencies()' to get all suggested dependencies</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">test_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">)</span>, <span class="fl">500L</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">titanic</span><span class="op">[</span><span class="op">-</span><span class="va">test_rows</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1707 obs. of  8 variables:</span></span>
<span><span class="co">#&gt;  $ gender  : Factor w/ 2 levels "female","male": 2 1 1 2 2 1 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ age     : num  42 39 16 25 30 28 27 20 30 27 ...</span></span>
<span><span class="co">#&gt;  $ class   : Factor w/ 7 levels "1st","2nd","3rd",..: 3 3 3 3 2 2 3 3 3 3 ...</span></span>
<span><span class="co">#&gt;  $ embarked: Factor w/ 4 levels "Belfast","Cherbourg",..: 4 4 4 4 2 2 2 4 4 4 ...</span></span>
<span><span class="co">#&gt;  $ fare    : num  7.11 20.05 7.13 7.13 24 ...</span></span>
<span><span class="co">#&gt;  $ sibsp   : num  0 1 0 0 1 1 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ parch   : num  0 1 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ survived: Factor w/ 2 levels "no","yes": 1 2 2 2 1 2 2 2 1 1 ...</span></span>
<span><span class="va">test</span>  <span class="op">&lt;-</span> <span class="va">titanic</span><span class="op">[</span> <span class="va">test_rows</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    500 obs. of  8 variables:</span></span>
<span><span class="co">#&gt;  $ gender  : Factor w/ 2 levels "female","male": 2 2 1 2 2 2 2 2 1 2 ...</span></span>
<span><span class="co">#&gt;  $ age     : num  74 19 32 21 40 23 24 26 34 28 ...</span></span>
<span><span class="co">#&gt;  $ class   : Factor w/ 7 levels "1st","2nd","3rd",..: 3 3 2 3 4 3 5 5 2 5 ...</span></span>
<span><span class="co">#&gt;  $ embarked: Factor w/ 4 levels "Belfast","Cherbourg",..: 4 2 4 4 4 4 4 4 4 1 ...</span></span>
<span><span class="co">#&gt;  $ fare    : num  7.15 7.04 21 8.08 0 ...</span></span>
<span><span class="co">#&gt;  $ sibsp   : num  0 0 0 0 0 0 0 0 1 0 ...</span></span>
<span><span class="co">#&gt;  $ parch   : num  0 0 0 0 0 0 0 0 1 0 ...</span></span>
<span><span class="co">#&gt;  $ survived: Factor w/ 2 levels "no","yes": 1 1 2 1 1 1 2 1 2 2 ...</span></span></code></pre></div>
<p>For each model type, we fit a classification model using the training
dataset of 1707 people and an interpretative MID surrogate of the target
model using the same dataset. We then evaluate the predictive accuracy
of the target model by AUC and the representation accuracy of the
surrogate model by the Spearman’s rank correlation coefficient between
two predicted probabilities.</p>
<p>In the following examples, we use two specialized link functions for
classification tasks: <code>translogit</code> (transformed-logit) and
<code>transprobit</code> (transformed-probit). These two link functions
are transformed so that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">g(0.5) = 0.5</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">g'(0.5) = 1</annotation></semantics></math>.
With these link functions, the effects on the linear predictor can be
approximately interpreted as the upper bound of the effects on the
predicted probabilities.</p>
<p><img src="classification_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="" width="576"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define utility functions for the following chunks</span></span>
<span><span class="va">effect_plots</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mid.plots.html">mid.plots</a></span><span class="op">(</span><span class="va">mid</span>, terms <span class="op">=</span> <span class="fu"><a href="../reference/mid.terms.html">mid.terms</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"main effect"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">plots</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">interaction_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">object</span>, <span class="va">term</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">theme</span> <span class="op">=</span> <span class="st">"shap"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">term</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mid.terms.html">mid.terms</a></span><span class="op">(</span><span class="fu"><a href="../reference/mid.importance.html">mid.importance</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, main.effect <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="../reference/ggmid.html">ggmid</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">term</span>, type <span class="op">=</span> <span class="st">"data"</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">)</span>, </span>
<span>        theme <span class="op">=</span> <span class="va">theme</span>, main.effects <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"interaction effect plot"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ice_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">variable</span> <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ggmid.html">ggmid</a></span><span class="op">(</span><span class="fu"><a href="../reference/mid.conditional.html">mid.conditional</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">variable</span>,</span>
<span>                        data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">titanic</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>        var.color <span class="op">=</span> <span class="va">gender</span>, theme <span class="op">=</span> <span class="st">"shap_r"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"conditional expectation"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">importance_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ggmid.html">ggmid</a></span><span class="op">(</span><span class="fu"><a href="../reference/mid.importance.html">mid.importance</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, <span class="st">"heatmap"</span>, theme <span class="op">=</span> <span class="st">"grayscale"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"feature importance"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">evaluation_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">mid</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.yhat.html">get.yhat</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">test</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">pred_mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get.yhat.html">get.yhat</a></span><span class="op">(</span><span class="va">mid</span>, <span class="va">test</span><span class="op">)</span></span>
<span>  <span class="va">actual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">survived</span> <span class="op">==</span> <span class="st">"yes"</span><span class="op">)</span></span>
<span>  <span class="va">auc_vs_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="va">actual</span>, <span class="va">pred</span><span class="op">)</span></span>
<span>  <span class="va">cor_vs_mid</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">pred_mid</span>, method <span class="op">=</span> <span class="st">"spearman"</span>,</span>
<span>                     use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/scale_color_theme.html">scale_color_theme</a></span><span class="op">(</span><span class="st">"Accent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pred</span>, y <span class="op">=</span> <span class="va">pred_mid</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#4378bf"</span>,</span>
<span>               data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">pred_mid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"model-prediction"</span>, y <span class="op">=</span> <span class="st">"mid-prediction"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, family <span class="op">=</span> <span class="st">"serif"</span>, size <span class="op">=</span> <span class="fl">3</span>, x <span class="op">=</span> <span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"vs test (AUC)       : %.3f\nvs mid (Spearman): %.3f"</span>,</span>
<span>                      <span class="va">auc_vs_test</span>, <span class="va">cor_vs_mid</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"representation accuracy"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="additive-models">Additive Models<a class="anchor" aria-label="anchor" href="#additive-models"></a>
</h2>
<div class="section level3">
<h3 id="logistic-regression">Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">==</span> <span class="st">"yes"</span> <span class="op">~</span> <span class="va">.</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpret.html">interpret</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span>, <span class="va">train</span>, <span class="va">model</span>, link <span class="op">=</span> <span class="st">"translogit"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; interpret(formula = survived ~ .^2, data = train, model = model,</span></span>
<span><span class="co">#&gt;  link = "translogit")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Class: glm, lm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercept: 0.26975</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Effects:</span></span>
<span><span class="co">#&gt; 7 main effect terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interactions:</span></span>
<span><span class="co">#&gt; 21 interaction terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uninterpreted Variation Ratio: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu">effect_plots</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/stats_glm-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>             <span class="fu">importance_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">interaction_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">ice_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">evaluation_plot</span><span class="op">(</span><span class="va">model</span>, <span class="va">mid</span>, target <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/stats_glm-2.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="neural-network">Neural Network<a class="anchor" aria-label="anchor" href="#neural-network"></a>
</h2>
<div class="section level3">
<h3 id="single-hidden-layer-network">Single Hidden Layer Network<a class="anchor" aria-label="anchor" href="#single-hidden-layer-network"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">nnet</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, size <span class="op">=</span> <span class="fl">5</span>, maxit <span class="op">=</span> <span class="fl">1e3</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpret.html">interpret</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span>, <span class="va">train</span>, <span class="va">model</span>, link <span class="op">=</span> <span class="st">"transprobit"</span>,</span>
<span>                 lambda <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; interpret(formula = survived ~ .^2, data = train, model = model,</span></span>
<span><span class="co">#&gt;  link = "transprobit", lambda = 0.01)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Class: nnet.formula, nnet</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercept: 0.29558</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Effects:</span></span>
<span><span class="co">#&gt; 7 main effect terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interactions:</span></span>
<span><span class="co">#&gt; 21 interaction terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uninterpreted Variation Ratio: 0.045592</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu">effect_plots</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/nnet_nnet-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>             <span class="fu">importance_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">interaction_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">ice_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">evaluation_plot</span><span class="op">(</span><span class="va">model</span>, <span class="va">mid</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/nnet_nnet-2.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="support-vector-machine">Support Vector Machine<a class="anchor" aria-label="anchor" href="#support-vector-machine"></a>
</h2>
<div class="section level3">
<h3 id="rbf-kernel-svm">RBF Kernel SVM<a class="anchor" aria-label="anchor" href="#rbf-kernel-svm"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'e1071'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     element</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, kernel <span class="op">=</span> <span class="st">"radial"</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpret.html">interpret</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span>, <span class="va">train</span>, <span class="va">model</span>, link <span class="op">=</span> <span class="st">"transprobit"</span>,</span>
<span>                 pred.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>target <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; interpret(formula = survived ~ .^2, data = train, model = model,</span></span>
<span><span class="co">#&gt;  pred.args = list(target = "yes"), link = "transprobit")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Class: svm.formula, svm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercept: 0.29569</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Effects:</span></span>
<span><span class="co">#&gt; 7 main effect terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interactions:</span></span>
<span><span class="co">#&gt; 21 interaction terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uninterpreted Variation Ratio: 0.0073507</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu">effect_plots</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/e1071_svm-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>             <span class="fu">importance_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">interaction_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">ice_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">evaluation_plot</span><span class="op">(</span><span class="va">model</span>, <span class="va">mid</span>, target <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/e1071_svm-2.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="tree-based-models">Tree Based Models<a class="anchor" aria-label="anchor" href="#tree-based-models"></a>
</h2>
<div class="section level3">
<h3 id="random-forest">Random Forest<a class="anchor" aria-label="anchor" href="#random-forest"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://imbs-hl.github.io/ranger/" class="external-link">ranger</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://imbs-hl.github.io/ranger/reference/ranger.html" class="external-link">ranger</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span>, <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpret.html">interpret</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span>, <span class="va">train</span>, <span class="va">model</span>,</span>
<span>                 link <span class="op">=</span> <span class="st">"transprobit"</span>, lambda <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; interpret(formula = survived ~ .^2, data = train, model = model,</span></span>
<span><span class="co">#&gt;  link = "transprobit", lambda = 0.01)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Class: ranger</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercept: 0.30031</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Effects:</span></span>
<span><span class="co">#&gt; 7 main effect terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interactions:</span></span>
<span><span class="co">#&gt; 21 interaction terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uninterpreted Variation Ratio: 0.062185</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu">effect_plots</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/ranger_ranger-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>             <span class="fu">importance_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">interaction_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">ice_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">evaluation_plot</span><span class="op">(</span><span class="va">model</span>, <span class="va">mid</span>, target <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/ranger_ranger-2.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level3">
<h3 id="decision-tree">Decision Tree<a class="anchor" aria-label="anchor" href="#decision-tree"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart" class="external-link">rpart</a></span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span><span class="op">)</span></span>
<span><span class="co"># create encoding frames for CART</span></span>
<span><span class="va">frm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">frame</span>, <span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">model</span>, collapse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">frm</span><span class="op">[</span><span class="va">frm</span><span class="op">$</span><span class="va">var</span> <span class="op">!=</span> <span class="st">"&lt;leaf&gt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"var"</span>, <span class="st">"ltemp"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       1        2       4       9       5        11        3       6        </span></span>
<span><span class="co">#&gt; var   "gender" "class" "age"   "sibsp" "age"    "fare"    "class" "fare"   </span></span>
<span><span class="co">#&gt; ltemp "b"      "bcefg" "&gt;=9.5" "&gt;=2.5" "&gt;=54.5" "&gt;=26.63" "c"     "&gt;=24.56"</span></span>
<span><span class="co">#&gt;       13      </span></span>
<span><span class="co">#&gt; var   "age"   </span></span>
<span><span class="co">#&gt; ltemp "&gt;=36.5"</span></span>
<span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">frames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">fun</span><span class="op">)</span></span>
<span><span class="va">frames</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">frames</span><span class="op">$</span><span class="va">age</span>, <span class="fl">9.5</span>, <span class="fl">54.5</span>, <span class="fl">36.5</span><span class="op">)</span></span>
<span><span class="va">frames</span><span class="op">$</span><span class="va">fare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">frames</span><span class="op">$</span><span class="va">fare</span>, <span class="fl">26.63</span>, <span class="fl">24.56</span><span class="op">)</span></span>
<span><span class="va">frames</span><span class="op">$</span><span class="va">sibsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">frames</span><span class="op">$</span><span class="va">fare</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpret.html">interpret</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span>, <span class="va">train</span>, <span class="va">model</span>, link <span class="op">=</span> <span class="st">"transprobit"</span>,</span>
<span>                 singular.ok <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="fl">0</span>, frames <span class="op">=</span> <span class="va">frames</span><span class="op">)</span></span>
<span><span class="co">#&gt; singular fit encountered</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; interpret(formula = survived ~ .^2, data = train, model = model,</span></span>
<span><span class="co">#&gt;  link = "transprobit", singular.ok = TRUE, type = 0, frames = frames)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Class: rpart</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercept: 0.29099</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Effects:</span></span>
<span><span class="co">#&gt; 7 main effect terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interactions:</span></span>
<span><span class="co">#&gt; 21 interaction terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uninterpreted Variation Ratio: 0.022918</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu">effect_plots</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/rpart_rpart-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>             <span class="fu">importance_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">interaction_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">ice_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">evaluation_plot</span><span class="op">(</span><span class="va">model</span>, <span class="va">mid</span>, target <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/rpart_rpart-2.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="other-models">Other Models<a class="anchor" aria-label="anchor" href="#other-models"></a>
</h2>
<div class="section level3">
<h3 id="predictive-mid">Predictive MID<a class="anchor" aria-label="anchor" href="#predictive-mid"></a>
</h3>
<p>To fit a MID model for the Titanic classification task, we can use
“one-sided” link functions: <code>identity-gaussian</code> or
<code>identity-logistic</code>. These link functions map
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>,
while the inverse link functions map any real number to the value in the
unit interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0, 1)</annotation></semantics></math>.</p>
<p><img src="classification_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="576"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpret.html">interpret</a></span><span class="op">(</span><span class="va">survived</span> <span class="op">~</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span>, <span class="va">train</span>,</span>
<span>                 link <span class="op">=</span> <span class="st">"identity-gaussian"</span>, lambda <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'model' not passed: response variable in 'data' is used</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; interpret(formula = survived ~ .^2, data = train, link = "identity-gaussian",</span></span>
<span><span class="co">#&gt;  lambda = 0.1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercept: 0.32285</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Effects:</span></span>
<span><span class="co">#&gt; 7 main effect terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interactions:</span></span>
<span><span class="co">#&gt; 21 interaction terms</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uninterpreted Variation Ratio: 0.61459</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu">effect_plots</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/midr_interpret-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>             <span class="fu">importance_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">interaction_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">ice_plot</span><span class="op">(</span><span class="va">mid</span><span class="op">)</span>,</span>
<span>             <span class="fu">interaction_plot</span><span class="op">(</span><span class="va">mid</span>, <span class="st">"age:class"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="classification_files/figure-html/midr_interpret-2.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryoichi Asashiba, Hirokazu Iwasawa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
